"use strict";const e=require("../../common/vendor.js");if(!Array){e.resolveComponent("uni-icons")()}Math;const a={__name:"login",setup(a){let t=e.ref(""),s=e.ref(""),o=e.ref("login"),i=e.ref("password"),l=e.ref("eye");function n(){e.index.navigateTo({url:"/pages/login/zhuce/zhuce"})}function u(){"password"==i.value?(l.value="eye-slash",i.value="text"):(l.value="eye",i.value="password")}return(a,r)=>({a:e.unref(t),b:e.o((a=>e.isRef(t)?t.value=a.detail.value:t=a.detail.value)),c:e.unref(i),d:e.unref(s),e:e.o((a=>e.isRef(s)?s.value=a.detail.value:s=a.detail.value)),f:e.o(u),g:e.p({type:e.unref(l),size:"30px"}),h:e.o(n),i:e.o((a=>(e.index.showLoading({title:"登录中",mask:!0}),void(""==t.value?(e.index.hideLoading(),e.index.showToast({title:"用户名不能为空",icon:"none"})):""==s.value?(e.index.hideLoading(),e.index.showToast({title:"密码不能为空",icon:"none"})):""!=t.value&&""!=s.value&&e.Es.callFunction({name:"user",data:{username:t.value,password:s.value,api:o.value}}).then((a=>{getApp().globalData.UID=a.result.user.UID,getApp().globalData.Plugins=a.result.user.token,getApp().globalData.ServiceIp=a.result.user.ip,getApp().globalData.zhucheMa=a.result.user.zhucema,getApp().globalData.asstoken=a.result.asstoken,getApp().globalData.assxtoken=a.result.assxtoken,getApp().globalData.name=a.result.user.name,getApp().globalData.img=a.result.user.img,e.index.hideLoading(),e.index.showToast({title:"登录成功",icon:"success"}),setTimeout((()=>{e.index.redirectTo({url:"/pages/index/index"})}),1600)})).catch((a=>{e.index.hideLoading(),"密码错误"==a.message&&e.index.showToast({title:"密码或账号错误",icon:"error"}),"用户不存在"==a.message&&e.index.showToast({title:"用户不存在",icon:"error"})}))))))})}};wx.createPage(a);
