"use strict";const e=require("../../../common/vendor.js");if(!Array){e.resolveComponent("uni-easyinput")()}Math;const a={__name:"zhuce",setup(a){let t=e.ref(""),l=e.ref(""),o=e.ref(0),n=e.ref("IP地址或域名"),u=e.ref(""),r=e.ref("插件token"),i=e.ref(""),s=e.ref("游戏UID"),d=e.ref(""),p=e.ref("Service");e.ref(getApp().globalData.code);let v=e.reactive({list:[{name:"服主注册"},{name:"玩家注册"}],styles:{color:"#666",background:"rgba(255, 255, 255, .1)",border:" 1px solid #ffffff"}});e.onLoad((()=>{getApp().globalData.code&&c()}));let g=e=>{o.value=e,1===e?(p.value="Player",r.value="邀请码,也可不填"):(p.value="Service",r.value="游戏UID")},f={},c=()=>{if(!getApp().globalData.code){let a=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/g,o=/^(?![a-zA-Z]+$)(?!\d+$)(?![^\da-zA-Z\s]+$).{1,9}$/g,n=/^((?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:(?:(?:[a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*(?:[A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\-]*[A-Za-z0-9]){2,}))$/g;if("Service"===p.value){if(""===t.value||""===l.value||""===u.value||""===i.value||""===d.value)return void e.index.showToast({title:"不能为空",icon:"error"});if(!a.test(t.value))return void e.index.showToast({title:"用户名格式不正确",icon:"none"});if(!o.test(l.value))return void e.index.showToast({title:"密码格式不正确,密码为由字母、数字、特殊字符，任意2种组成，1-9位",icon:"none"});if(!n.test(u.value))return void e.index.showToast({title:"IP地址或域名格式不正确",icon:"none"});e.index.request({url:"https://"+u.value+"/opencommand/api",method:"POST",data:{action:"ping"}}).catch((a=>{e.index.showToast({title:"此IP或域名可能不支持gc-opencommand-plugin插件",icon:"none",duration:2e3})})),f.UID=d.value,f.ip=u.value,f.token=i.value,f.api=p.value}else{if(""===t.value||""===l.value||""===d.value)return void e.index.showToast({title:"不能为空",icon:"error"});if(!a.test(t.value))return void e.index.showToast({title:"用户名格式不正确",icon:"error"});if(!o.test(l.value))return void e.index.showToast({title:"密码格式不正确,密码为字母、数字、特殊字符，任意2种组成，1-9位",icon:"none"});if(!/^$|^\d{5,}$/.test(i.value))return void e.index.showToast({title:"邀请码不正确，需要5位的数字",icon:"none"});f.api=p.value,f.zhucema=i.value,f.UID=d.value}}getApp().globalData.code?e.Es.callFunction({name:"user",data:{username:getApp().globalData.username,password:getApp().globalData.password,api:"enroll",date:getApp().globalData.date}}).then((a=>{getApp().globalData.UID=a.result.user.UID,getApp().globalData.Plugins=a.result.user.token,getApp().globalData.ServiceIp=a.result.user.ip,getApp().globalData.zhucheMa=a.result.user.zhucema,getApp().globalData.asstoken=a.result.asstoken,getApp().globalData.assxtoken=a.result.assxtoken,getApp().globalData.name=a.result.user.name,getApp().globalData.img=a.result.user.img,e.index.showToast({title:"注册成功",icon:"success"}),setTimeout((()=>{e.index.redirectTo({url:"/pages/index/index"})}),1600)})):(e.index.showToast({title:"请验证",icon:"none"}),getApp().globalData.username=t.value,getApp().globalData.password=l.value,getApp().globalData.date=f,e.index.reLaunch({url:"/pages/login/yanzhenma"}))};return(a,p)=>({a:e.f(e.unref(v).list,((a,t,l)=>({a:e.t(a.name),b:t,c:e.unref(o)===t?1:"",d:e.o((a=>e.unref(g)(t)),t)}))),b:e.unref(t),c:e.o((a=>e.isRef(t)?t.value=a.detail.value:t=a.detail.value)),d:e.o((a=>e.isRef(l)?l.value=a:l=a)),e:e.p({type:"password",maxlength:"16",placeholder:"请输入密码,密码为字母、数字、特殊字符，任意2种组成，1-9位",styles:e.unref(v).styles,modelValue:e.unref(l)}),f:e.t(e.unref(n)),g:0===e.unref(o),h:0===e.unref(o),i:e.unref(u),j:e.o((a=>e.isRef(u)?u.value=a.detail.value:u=a.detail.value)),k:e.t(e.unref(r)),l:"请输入"+e.unref(r),m:e.unref(i),n:e.o((a=>e.isRef(i)?i.value=a.detail.value:i=a.detail.value)),o:e.t(e.unref(s)),p:e.unref(d),q:e.o((a=>e.isRef(d)?d.value=a.detail.value:d=a.detail.value)),r:e.o((a=>e.unref(c)()))})}};wx.createPage(a);
